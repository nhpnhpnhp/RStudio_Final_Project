---
title: "Phân tích Dịch COVID-19: Kết quả các Mô hình Machine Learning"
author: "Lưu Trần Kim Phú - 23133055"
date: "2025-05-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = "D:/Đại học/TL-HOCKI2.2/TL_LT_R_CPT_QT/DoAn_R/FinalDataR/COVID19_Analysis")
library(tidyverse)
library(ggplot2)
library(reshape2)
library(prophet)
library(caret)
library(cluster)
library(randomForest)
library(reshape2)
```

##Mô tả
**Phần này trình bày kết quả từ 4 mô hình Machine Learning:**
  - **Regression: Dự đoán số ca nhiễm mới (New cases) bằng hồi quy tuyến *tính.**
  - **Time Series: Dự đoán xu hướng ca nhiễm mới trong tương lai bằng Prophet.**
  - **Clustering: Phân cụm quốc gia dựa trên Death_Rate và Test_Rate bằng K-Means.**
  - **Classification: Phân loại quốc gia có nguy cơ cao/thấp dựa trên Death_Rate bằng Random Forest.**
  
##Kết quả:
**1.Regression: Dự đoán số ca nhiễm mới**
```{r}
  reg_predictions <- read_csv("output/regression_predictions.csv")
  comparison_data <- reg_predictions %>%
    select(`New cases`, Predicted_New_cases) %>%
    pivot_longer(cols = c(`New cases`, Predicted_New_cases), names_to = "Type", values_to = "Value")
  ggplot(comparison_data, aes(x = 1:nrow(comparison_data), y = Value, color = Type)) +
    geom_line() +
    labs(title = "So sánh giá trị thực tế và dự đoán (Regression)", x = "Observation", y = "New Cases") +
    theme_minimal()
```

**2. Time Series: Dự đoán xu hướng ca nhiễm mới**
```{r}
forecast <- read_csv("output/prophet_forecast.csv")
ggplot(forecast, aes(x = ds, y = yhat)) +
  geom_line(color = "blue") +
  geom_ribbon(aes(ymin = yhat_lower, ymax = yhat_upper), alpha = 0.2) +
  labs(title = "Dự đoán xu hướng ca nhiễm mới (Prophet)", x = "Date", y = "New Cases") +
  theme_minimal()
```

**3. Clustering: Phân cụm quốc gia**

```{r}
clustered_data <- read_csv("output/clustered_data.csv")
ggplot(clustered_data, aes(x = Death_Rate, y = Test_Rate, color = Cluster)) +
  geom_point() +
  labs(title = "Phân cụm quốc gia theo Death_Rate và Test_Rate", x = "Death Rate (%)", y = "Test Rate (%)") +
  theme_minimal()
```

**4. Classification: Phân loại nguy cơ cao/thấp**
```{r}
class_predictions <- read_csv("output/classification_predictions.csv")
ggplot(class_predictions, aes(x = Risk_Level, fill = Predicted_Risk_Level)) +
  geom_bar(position = "dodge") +
  labs(title = "Phân loại nguy cơ cao/thấp", x = "Actual Risk Level", y = "Count", fill = "Predicted Risk Level") +
  theme_minimal()
```

##Nhận xét: 
-**Regression: Mô hình hồi quy tuyến tính cho kết quả dự đoán tương đối sát với giá trị thực tế, nhưng có thể cải thiện bằng cách thêm đặc trưng hoặc thử mô hình phi tuyến.**
-**Time Series: Mô hình Prophet dự đoán xu hướng ca nhiễm mới khá tốt, với khoảng tin cậy hợp lý.**
-**Clustering: Các quốc gia được chia thành 3 cụm, cho thấy sự khác biệt rõ rệt về tỷ lệ tử vong và xét nghiệm.**
-**Classification: Mô hình Random Forest phân loại quốc gia nguy cơ cao/thấp với độ chính xác cao, phù hợp để đánh giá rủi ro.**
