---
title: "Untitled"
output: html_document
date: "2025-04-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```
1. Tổng quan dữ liệu
```{r}
install.packages('corrplot')
library(ggplot2)
library(dplyr)
library(tidyr)
# Đọc dữ liệu
day_wise <- read.csv("day_wise.csv")

# Xem cấu trúc dữ liệu
str(day_wise)
# Chuyển đổi cột Date sang định dạng ngày tháng
day_wise$Date <- as.Date(day_wise$Date)

# Tóm tắt thống kê cơ bản
summary(day_wise)
```
2.Phân tích xu hướng theo thời gian
```{r}
# Tổng số ca nhiễm theo thời gian
ggplot(day_wise, aes(x = Date, y = Confirmed)) +
  geom_line(color = "blue") +
  labs(title = "Tổng số ca nhiễm COVID-19 theo thời gian",
       x = "Ngày", y = "Số ca nhiễm") +
  theme_minimal()

# Số ca mới mỗi ngày
ggplot(day_wise, aes(x = Date, y = New.cases)) +
  geom_col(fill = "orange") +
  labs(title = "Số ca nhiễm mới mỗi ngày",
       x = "Ngày", y = "Số ca mới") +
  theme_minimal()

# Tỷ lệ tử vong và hồi phục
data_long <- day_wise %>%
  select(Date, Deaths, Recovered) %>%
  pivot_longer(cols = c(Deaths, Recovered), 
               names_to = "Type", 
               values_to = "Count")

ggplot(data_long, aes(x = Date, y = Count, color = Type)) +
  geom_line() +
  labs(title = "So sánh số ca tử vong và hồi phục",
       x = "Ngày", y = "Số lượng") +
  scale_color_manual(values = c("red", "green")) +
  theme_minimal()
```
3.Phân tích tỷ lệ
```{r}
# Tỷ lệ tử vong trên tổng số ca nhiễm
ggplot(day_wise, aes(x = Date, y = Deaths...100.Cases)) +
  geom_line(color = "red") +
  labs(title = "Tỷ lệ tử vong trên 100 ca nhiễm",
       x = "Ngày", y = "Tỷ lệ (%)") +
  theme_minimal()

# Tỷ lệ hồi phục trên tổng số ca nhiễm
ggplot(day_wise, aes(x = Date, y = Recovered...100.Cases)) +
  geom_line(color = "green") +
  labs(title = "Tỷ lệ hồi phục trên 100 ca nhiễm",
       x = "Ngày", y = "Tỷ lệ (%)") +
  theme_minimal()

# Tỷ lệ tử vong trên tổng số ca hồi phục
ggplot(day_wise, aes(x = Date, y = Deaths...100.Recovered)) +
  geom_line(color = "blue") +
  labs(title = "Tỷ lệ tử vong trên 100 ca hồi phục",
       x = "Ngày", y = "Tỷ lệ (%)") +
  theme_minimal()
```
4.Phân tích tương quan
```{r}
# Tương quan giữa các biến
correlation <- cor(day_wise[, c("Confirmed", "Deaths", "Recovered", "Active")])
print(correlation)

# Biểu đồ tương quan
library(corrplot)
corrplot(correlation, method = "circle")
```

5.Dự đoán số ca nhiễm
```{r}
# Tạo mô hình dự đoán số ca nhiễm
model <- lm(Confirmed ~ as.numeric(Date), data = day_wise)
summary(model)

# Dự đoán cho 7 ngày tiếp theo
future_dates <- seq(max(day_wise$Date) + 1, by = "day", length.out = 7)
predictions <- predict(model, newdata = data.frame(Date = as.numeric(future_dates)))

# Hiển thị kết quả dự đoán
prediction_data <- data.frame(
  Date = future_dates,
  Predicted = predictions
)

print(prediction_data)

# Vẽ biểu đồ dự đoán
ggplot() +
  geom_line(data = day_wise, aes(x = Date, y = Confirmed), color = "blue") +
  geom_line(data = prediction_data, aes(x = Date, y = Predicted), 
            color = "red", linetype = "dashed") +
  labs(title = "Dự đoán số ca nhiễm COVID-19",
       x = "Ngày", y = "Số ca nhiễm") +
  theme_minimal()

```

6. Phân tích tốc độ tăng trưởng

```{r}
# Tính tốc độ tăng trưởng hàng ngày
day_wise$GrowthRate <- c(NA, diff(day_wise$Confirmed) / day_wise$Confirmed[-nrow(day_wise)] * 100)

# Biểu đồ tốc độ tăng trưởng
ggplot(day_wise, aes(x = Date, y = GrowthRate)) +
  geom_line(color = "purple") +
  labs(title = "Tốc độ tăng trưởng số ca nhiễm hàng ngày",
       x = "Ngày", y = "Tốc độ tăng trưởng (%)") +
  theme_minimal()
```
7.Phân tích số quốc gia bị ảnh hưởng
```{r}
ggplot(day_wise, aes(x = Date, y = No..of.countries)) +
  geom_line(color = "brown") +
  labs(title = "Số quốc gia bị ảnh hưởng theo thời gian",
       x = "Ngày", y = "Số quốc gia") +
  theme_minimal()
```

