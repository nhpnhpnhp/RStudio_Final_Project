---
title: "Untitled"
output: html_document
date: "2025-04-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Ph√¢n t√≠ch s·ªë li·ªáu th·∫ø gi·ªõi theo t·ª´ng qu·ªëc gia m·ªói ng√†y(covid_19_clean_complete.csv)
  1.ƒê·ªçc d·ªØ li·ªáu
```{r}
# Load c√°c th∆∞ vi·ªán
library(tidyverse)
library(lubridate)
library(ggplot2)
library(plotly)
library(maps)
library(leaflet)
library(gridExtra)

# ƒê·ªçc d·ªØ li·ªáu t·ª´ file CSV
covid_19_clean_complete<-read_csv('covid_19_clean_complete.csv')
# Xem c·∫•u tr√∫c d·ªØ li·ªáu
glimpse(covid_19_clean_complete)
# Ki·ªÉm tra d·ªØ li·ªáu thi·∫øu
sum(is.na(covid_19_clean_complete))
colSums(is.na(covid_19_clean_complete))
```

  2.Qua k·∫øt qu·∫£ tr√™n ta th·∫•y ch·ªâ c√≥ c·ªôt Province/State l√† c√≥ r·∫•t nhi·ªÅu √¥ tr·ªëng n√™n ta s·∫Ω x·ª≠ l√≠ cho c√°c √¥ tr·ªëng c·ªßa c·ªôt ƒë√≥ l√† 'Unknown' v√† chuy·ªÉn ƒë·ªïi ki·ªÉu d·ªØ li·ªáu c·ªßa c·ªôt Date th√†nh ki·ªÉu d·ªØ li·ªáu Date
```{r}
# X·ª≠ l√Ω d·ªØ li·ªáu thi·∫øu cho c·ªôt Province/State
covid_19_clean_complete <- covid_19_clean_complete %>% 
  mutate(`Province/State` = ifelse(is.na(`Province/State`), "Unknown", `Province/State`))
# Chuy·ªÉn ƒë·ªïi ki·ªÉu d·ªØ li·ªáu ng√†y th√°ng
covid_19_clean_complete<- covid_19_clean_complete %>% 
  mutate(Date = as.Date(Date))
# Ki·ªÉm tra l·∫°i d·ªØ li·ªáu
summary(covid_19_clean_complete)
```
  3.Ph√¢n t√≠ch t·ªïng quan
```{r}
# T·ªïng s·ªë ca nhi·ªÖm, t·ª≠ vong v√† h·ªìi ph·ª•c theo th·ªùi gian
daily_summary <- covid_19_clean_complete %>% 
  group_by(Date) %>% 
  summarise(
    Total_Confirmed = sum(Confirmed, na.rm = TRUE),
    Total_Deaths = sum(Deaths, na.rm = TRUE),
    Total_Recovered = sum(Recovered, na.rm = TRUE),
    Total_Active = sum(Active, na.rm = TRUE)
  )
# Hi·ªÉn th·ªã bi·ªÉu ƒë·ªì t·ªïng quan
ggplot(daily_summary, aes(x = Date)) +
  geom_line(aes(y = Total_Confirmed, color = "Confirmed"), size = 1) +
  geom_line(aes(y = Total_Deaths, color = "Deaths"), size = 1) +
  geom_line(aes(y = Total_Recovered, color = "Recovered"), size = 1) +
  scale_color_manual(values = c("Confirmed" = "orange", "Deaths" = "red", "Recovered" = "green")) +
  labs(title = "COVID-19 Cases Over Time", 
       x = "Date", 
       y = "Number of Cases", 
       color = "Case Type") +
  theme_minimal()
```
  4.Ph√¢n t√≠ch theo qu·ªëc gia/khu v·ª±c
```{r}
# Top 10 qu·ªëc gia b·ªã ·∫£nh h∆∞·ªüng n·∫∑ng nh·∫•t
top_countries <- covid_19_clean_complete %>% 
  group_by(`Country/Region`) %>% 
  summarise(
    Total_Confirmed = sum(Confirmed, na.rm = TRUE),
    Total_Deaths = sum(Deaths, na.rm = TRUE),
    Total_Recovered = sum(Recovered, na.rm = TRUE)
  ) %>% 
  arrange(desc(Total_Confirmed)) %>% 
  head(10)
top_countries

# Bi·ªÉu ƒë·ªì c·ªôt cho top 10 qu·ªëc gia
ggplot(top_countries, aes(x = reorder(`Country/Region`, -Total_Confirmed), y = Total_Confirmed)) +
  geom_col(fill = "steelblue") +
  geom_text(aes(label = Total_Confirmed), vjust = -0.5) +
  labs(title = "Top 10 Countries by Confirmed Cases", 
       x = "Country", 
       y = "Confirmed Cases") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# T·ª∑ l·ªá t·ª≠ vong theo qu·ªëc gia
country_stats <- covid_19_clean_complete %>% 
  group_by(`Country/Region`) %>% 
  summarise(
    Confirmed = sum(Confirmed, na.rm = TRUE),
    Deaths = sum(Deaths, na.rm = TRUE),
    Recovered = sum(Recovered, na.rm = TRUE),
    Mortality_Rate = ifelse(Confirmed > 0, Deaths/Confirmed * 100, 0)
  ) %>% 
  filter(Confirmed > 1000) %>% 
  arrange(desc(Mortality_Rate))

head(country_stats)
```
  5.Ph√¢n t√≠ch theo khu v·ª±c WHO v·ªõi Mortality_Rate(t·ªâ l·ªá t·ª≠ vong)=(Deaths/Confirmed)x100
```{r}
# Ph√¢n t√≠ch theo khu v·ª±c WHO
who_region_stats <- covid_19_clean_complete %>% 
  group_by(`WHO Region`) %>% 
  summarise(
    Confirmed = sum(Confirmed, na.rm = TRUE),
    Deaths = sum(Deaths, na.rm = TRUE),
    Recovered = sum(Recovered, na.rm = TRUE),
    Mortality_Rate = ifelse(Confirmed > 0, Deaths/Confirmed * 100, 0)
  ) %>% 
  arrange(desc(Confirmed))
who_region_stats

 #Bi·ªÉu ƒë·ªì tr√≤n cho ph√¢n b·ªë ca nhi·ªÖm theo khu v·ª±c
plot_ly(who_region_stats, labels = ~`WHO Region`, values = ~Confirmed, type = 'pie') %>%
  layout(title = 'Distribution of COVID-19 Cases by WHO Region')
```

 
  7.S·ª± t∆∞∆°ng quan gi·ªØa c√°c bi·∫øn
```{r}

selected_country <- "Italy"

# L·ªçc d·ªØ li·ªáu cho qu·ªëc gia ƒë√≥ v√† t·ªïng h·ª£p theo ng√†y
country_data <- covid_19_clean_complete %>%
  filter(`Country/Region` == selected_country) %>%
  group_by(Date) %>%
  summarise(
    Confirmed = sum(Confirmed, na.rm = TRUE),
    Deaths = sum(Deaths, na.rm = TRUE),
    Recovered = sum(Recovered, na.rm = TRUE)
  ) %>%
  filter(Confirmed > 0 & Recovered > 0)  # lo·∫°i b·ªè c√°c d√≤ng ch∆∞a c√≥ d·ªØ li·ªáu

# H·ªìi quy tuy·∫øn t√≠nh: D·ª± ƒëo√°n s·ªë ca t·ª≠ vong theo s·ªë ca nhi·ªÖm v√† h·ªìi ph·ª•c
lm_model <- lm(Deaths ~ Confirmed + Recovered, data = country_data)
model_summary <- summary(lm_model)

# In k·∫øt qu·∫£ m√¥ h√¨nh
print(model_summary)

# Tr√≠ch xu·∫•t c√°c th√¥ng tin
r_squared <- model_summary$r.squared
intercept <- coef(model_summary)[1]
confirmed_coef <- coef(model_summary)[2]
recovered_coef <- coef(model_summary)[3]
confirmed_p <- coef(summary(lm_model))["Confirmed", "Pr(>|t|)"]
recovered_p <- coef(summary(lm_model))["Recovered", "Pr(>|t|)"]

# Di·ªÖn gi·∫£i
cat("\n--- Di·ªÖn gi·∫£i m√¥ h√¨nh h·ªìi quy cho", selected_country, "---\n")
cat(sprintf("M√¥ h√¨nh gi·∫£i th√≠ch %.1f%% ph∆∞∆°ng sai c·ªßa s·ªë ca t·ª≠ vong (R¬≤ = %.2f).\n", 
            r_squared * 100, r_squared))

cat(sprintf("Khi s·ªë ca nhi·ªÖm tƒÉng th√™m 1, s·ªë ca t·ª≠ vong ∆∞·ªõc t√≠nh tƒÉng trung b√¨nh %.4f ca. ", confirmed_coef))
if (confirmed_p < 0.05) {
  cat("·∫¢nh h∆∞·ªüng c√≥ √Ω nghƒ©a th·ªëng k√™ (p < 0.05).\n")
} else {
  cat("·∫¢nh h∆∞·ªüng KH√îNG c√≥ √Ω nghƒ©a th·ªëng k√™ (p ‚â• 0.05).\n")
}

cat(sprintf("Khi s·ªë ca h·ªìi ph·ª•c tƒÉng th√™m 1, s·ªë ca t·ª≠ vong ∆∞·ªõc t√≠nh tƒÉng trung b√¨nh %.4f ca. ", recovered_coef))
if (recovered_p < 0.05) {
  cat("·∫¢nh h∆∞·ªüng c√≥ √Ω nghƒ©a th·ªëng k√™ (p < 0.05).\n")
} else {
  cat("·∫¢nh h∆∞·ªüng KH√îNG c√≥ √Ω nghƒ©a th·ªëng k√™ (p ‚â• 0.05).\n")
}

```

```{r}
anova_data <- covid_19_clean_complete %>%
  group_by(`Country/Region`, `WHO Region`) %>%
  summarise(
    Confirmed = sum(Confirmed),
    Deaths = sum(Deaths),
    .groups = "drop"
  ) %>%
  filter(Confirmed > 1000) %>%  # L·ªçc b·ªõt c√°c qu·ªëc gia c√≥ √≠t d·ªØ li·ªáu
  mutate(Mortality_Rate = Deaths / Confirmed * 100)

# Ki·ªÉm ƒë·ªãnh ANOVA
anova_model <- aov(Mortality_Rate ~ `WHO Region`, data = anova_data)
summary(anova_model)

remove_outliers <- function(data, column_name) {
  Q1 <- quantile(data[[column_name]], 0.25, na.rm = TRUE)
  Q3 <- quantile(data[[column_name]], 0.75, na.rm = TRUE)
  IQR_value <- Q3 - Q1
  lower_bound <- Q1 - 1.5 * IQR_value
  upper_bound <- Q3 + 1.5 * IQR_value

  # Ghi nh·∫≠n c√°c gi√° tr·ªã b·ªã lo·∫°i
  outliers <- data %>% filter(data[[column_name]] < lower_bound | data[[column_name]] > upper_bound)

  # Xo√° c√°c gi√° tr·ªã ngo·∫°i l·ªá
  cleaned_data <- data %>% filter(data[[column_name]] >= lower_bound & data[[column_name]] <= upper_bound)

  return(list(cleaned_data = cleaned_data, outliers = outliers))
}
# T√¨m v√† lo·∫°i b·ªè ngo·∫°i l·ªá trong c·ªôt Mortality_Rate
outlier_result <- remove_outliers(anova_data, "Mortality_Rate")

# D·ªØ li·ªáu sau khi lo·∫°i b·ªè
anova_clean <- outlier_result$cleaned_data

# D·ªØ li·ªáu ngo·∫°i l·ªá b·ªã lo·∫°i b·ªè (n·∫øu b·∫°n mu·ªën xem x√©t)
outlier_values <- outlier_result$outliers

# Ki·ªÉm tra k·∫øt qu·∫£
print(paste("S·ªë l∆∞·ª£ng ngo·∫°i l·ªá:", nrow(outlier_values)))
ggplot(anova_clean, aes(x = `WHO Region`, y = Mortality_Rate, fill = `WHO Region`)) +
  geom_violin(alpha = 0.6) +  # Violin Plot v·ªõi ƒë·ªô trong su·ªët 0.6
  geom_jitter(width = 0.2, alpha = 0.5, color = "black") +  # Jitter cho c√°c ƒëi·ªÉm
  labs(title = "Distribution of Mortality Rate by WHO Region",
       x = "WHO Region",
       y = "Mortality Rate (%)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none")  # T·∫Øt hi·ªÉn th·ªã legend
```
üîç C√°ch ƒë·ªçc bi·ªÉu ƒë·ªì Violin Plot:
1. Tr·ª•c ho√†nh (X-axis):
G·ªìm c√°c khu v·ª±c c·ªßa T·ªï ch·ª©c Y t·∫ø Th·∫ø gi·ªõi (WHO Region): Africa, Americas, Eastern Mediterranean, Europe, South-East Asia, Western Pacific.

2. Tr·ª•c tung (Y-axis):
Bi·ªÉu th·ªã t·ª∑ l·ªá t·ª≠ vong (%) = (Deaths / Confirmed) √ó 100 c·ªßa t·ª´ng qu·ªëc gia thu·ªôc m·ªói khu v·ª±c.

3. H√¨nh d√°ng "Violin":
H√¨nh d·∫°ng c·ªßa m·ªói violin bi·ªÉu th·ªã m·∫≠t ƒë·ªô ph√¢n ph·ªëi c·ªßa d·ªØ li·ªáu:

Ch·ªó ph√¨nh to: N∆°i c√≥ nhi·ªÅu qu·ªëc gia c√≥ t·ª∑ l·ªá t·ª≠ vong ·ªü m·ª©c ƒë√≥.

Ch·ªó h·∫πp l·∫°i: √çt qu·ªëc gia c√≥ t·ª∑ l·ªá t·ª≠ vong t·∫°i m·ª©c ƒë√≥.

4. C√°c ch·∫•m ƒëen (jitter):
M·ªói ch·∫•m l√† d·ªØ li·ªáu c·ªßa m·ªôt qu·ªëc gia. Ch√∫ng th·ªÉ hi·ªán c√°c gi√° tr·ªã th·ª±c t·∫ø.

Nh·ªù v·∫≠y b·∫°n c√≥ th·ªÉ v·ª´a th·∫•y ph√¢n b·ªë m·∫≠t ƒë·ªô, v·ª´a th·∫•y c√°c gi√° tr·ªã c·ª• th·ªÉ.

üìä Ph√¢n t√≠ch v√≠ d·ª• t·ª´ bi·ªÉu ƒë·ªì:
Africa: Ph√¢n ph·ªëi l·ªách ph·∫£i (right-skewed), nhi·ªÅu qu·ªëc gia c√≥ t·ª∑ l·ªá t·ª≠ vong th·∫•p (~1‚Äì2%), m·ªôt s·ªë qu·ªëc gia c√≥ gi√° tr·ªã cao h∆°n ~7‚Äì8%.

Europe: Tr·∫£i r·ªông h∆°n, c√≥ v·∫ª nh∆∞ t·ª∑ l·ªá t·ª≠ vong ph√¢n b·ªë t·ª´ kho·∫£ng 1% ƒë·∫øn h∆°n 7%, m·∫≠t ƒë·ªô d√†y h∆°n ·ªü kho·∫£ng gi·ªØa.

Western Pacific: Ph√¢n ph·ªëi kh√° h·∫πp, nhi·ªÅu qu·ªëc gia c√≥ t·ª∑ l·ªá t·ª≠ vong r·∫•t th·∫•p.

Eastern Mediterranean v√† Americas: T·ª∑ l·ªá t·ª≠ vong ƒëa d·∫°ng v√† c√≥ m·∫≠t ƒë·ªô ph√¢n ph·ªëi ƒë·ªÅu ·ªü nhi·ªÅu m·ª©c.

South-East Asia: C√≥ t·ª∑ l·ªá t·ª≠ vong nh√¨n chung kh√° th·∫•p.

‚úÖ 2. Di·ªÖn gi·∫£i k·∫øt qu·∫£ ki·ªÉm ƒë·ªãnh ANOVA
Sau khi ch·∫°y ANOVA b·∫±ng aov(Mortality_Rate ~ WHO Region, data = anova_data):

K·∫øt qu·∫£ b·∫°n s·∫Ω quan t√¢m:
p-value (Pr(>F)): ƒê√¢y l√† gi√° tr·ªã then ch·ªët ƒë·ªÉ ƒë√°nh gi√° s·ª± kh√°c bi·ªát.

Di·ªÖn gi·∫£i:
N·∫øu p-value < 0.05: C√≥ √Ω nghƒ©a th·ªëng k√™ ‚áí √≠t nh·∫•t m·ªôt khu v·ª±c c√≥ t·ª∑ l·ªá t·ª≠ vong trung b√¨nh kh√°c bi·ªát so v·ªõi ph·∫ßn c√≤n l·∫°i.

N·∫øu p-value ‚â• 0.05: Kh√¥ng c√≥ b·∫±ng ch·ª©ng ƒë·ªß m·∫°nh ƒë·ªÉ k·∫øt lu·∫≠n s·ª± kh√°c bi·ªát ƒë√°ng k·ªÉ.