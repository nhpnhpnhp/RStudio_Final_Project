---
title: "Untitled"
output: html_document
date: "2025-05-09"
---


Cài đặt các gói cần thiết;
Load các thư viện

```{r setup, include=FALSE}
library(tidyverse)
library(lubridate)
library(ggplot2)
library(plotly)
library(maps)
library(leaflet)
library(gridExtra)
```

Đọc dữ liệu từ file CSV

```{r}
covid <- read.csv("covid_19_clean_complete.csv", stringsAsFactors = FALSE)
```

Xử lý dữ liệu:

```{r pressure, echo=FALSE}
# 1. Xóa cột "Province/State"
covid <- covid[, !(names(covid) %in% "Province/State")]

# 2. Gom nhóm theo "Date" và "Country/Region", tính trung bình cho dữ liệu số, giữ lại 1 giá trị bất kỳ cho dữ liệu chuỗi
library(dplyr)

# Đảm bảo Date là dạng ngày
covid$Date <- as.Date(covid$Date, format = "%Y-%m-%d")

# Gom nhóm theo ngày và quốc gia
library(dplyr)
grouped_data <- covid %>%
  group_by(Date, Country.Region) %>%
  summarise(
    Confirmed = mean(Confirmed, na.rm = TRUE),
    Deaths = mean(Deaths, na.rm = TRUE),
    Recovered = mean(Recovered, na.rm = TRUE),
    .groups = 'drop'
  )

```

So sánh 2 quốc gia (Ví dụ: "Vietnam" và "Italy") vào ngày cụ thể (VD: "2020-03-20")

```{r}
country1 <- "Vietnam"
country2 <- "Italy"
compare_date <- as.Date("2020-03-20")

data_c1 <- grouped_data %>% filter(Country.Region == country1)
data_c2 <- grouped_data %>% filter(Country.Region == country2)

# Tạo bảng cho T-test
confirmed_all <- data.frame(
  Country = c(rep(country1, nrow(data_c1)), rep(country2, nrow(data_c2))),
  Confirmed = c(data_c1$Confirmed, data_c2$Confirmed)
)

# Thực hiện T-test
t_test_result <- t.test(Confirmed ~ Country, data = confirmed_all)

print("Kết quả T-Test toàn bộ thời gian:")
print(t_test_result)

# Kiểm tra p-value
if (t_test_result$p.value < 0.05) {
  print("=> Có ý nghĩa thống kê. Tiến hành so sánh.")
  
  # Tổng ca nhiễm theo thời gian
  total_c1 <- sum(data_c1$Confirmed, na.rm = TRUE)
  total_c2 <- sum(data_c2$Confirmed, na.rm = TRUE)
  
  print(paste0("Tổng ca nhiễm ", country1, ": ", round(total_c1)))
  print(paste0("Tổng ca nhiễm ", country2, ": ", round(total_c2)))
  print(paste0("Chênh lệch tổng: ", abs(total_c1 - total_c2)))
  
  # So sánh trong ngày cụ thể
  day_data <- grouped_data %>% filter(Date == compare_date & Country.Region %in% c(country1, country2))
  
  if(nrow(day_data) == 2){
    print("So sánh trong một ngày cụ thể:")
    print(day_data)
    print(paste0("Chênh lệch số ca nhiễm: ", abs(diff(day_data$Confirmed))))
  } else {
    print("Không đủ dữ liệu cho ngày này.")
  }
  
} else {
  print("=> Không có ý nghĩa thống kê (p >= 0.05). Không thực hiện so sánh.")
}
```

